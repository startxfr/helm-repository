{{- if .Values.operatorGroup }}{{- if .Values.operatorGroup.enabled }}
{{- $name := .Values.operatorGroup.name | default .Values.subscription.name -}}
{{- $namespace := .Values.operatorGroup.namespace | default .Values.subscription.namespace -}}
{{- $providedAPIs := .Values.operatorGroup.providedAPIs -}}
---
kind: OperatorGroup
apiVersion: operators.coreos.com/v1
metadata:
  name: {{ $name | default "default" | quote }}
  namespace: {{ $namespace | default "default" | quote }}
  labels:
    {{- include "operator.labels" . | nindent 4 }}
    app.kubernetes.io/name: "{{ $name }}-operatorgroup"
  annotations:
    {{- include "operator.annotations" . | nindent 4 }}
    olm.providedAPIs: {{ $providedAPIs | quote }}
    {{- if .Values.operatorGroup.hooked }}
    helm.sh/hook: pre-install,pre-upgrade,post-delete
    helm.sh/hook-weight: "0"
    helm.sh/hook-delete-policy: hook-failed
    {{- end }}
spec:
  targetNamespaces:
    - {{ $namespace | default "default" | quote }}
{{- end }}{{- end }}